$target="127.0.0.1"
$ports=1..65535

foreach ($port in $ports)
{
  if(Test-Connection -BufferSize 32 -Count 1 -Quiet -ComputerName $target)
  {
    Try
    {
      $socket = new-object System.Net.Sockets.TcpClient($ip, $port)
      If($socket.Connected)
      {
        "[+] $target listening to port $port"
        $socket.Close() 
      }
    }
    Catch
    {
      "[-] $target port $port appears closed"
    }
  }
}
